#!/usr/bin/env python
# coding: utf-8

# -----------------------------------------------------------------------------
# --- Flask ---
# -----------------------------------------------------------------------------
from flask import render_template
from flask_login import login_required, current_user

# -----------------------------------------------------------------------------
# --- Models ---
# -----------------------------------------------------------------------------
from app import models

# -----------------------------------------------------------------------------
# --- Forms ---
# -----------------------------------------------------------------------------
from app.main.views.forms import TaskForm

# -----------------------------------------------------------------------------
# --- Errors ---
# -----------------------------------------------------------------------------
from app.main.views.errors import errors

# -----------------------------------------------------------------------------
# --- Blueprint ---
# -----------------------------------------------------------------------------
from app.main.views import calendar_bp


# -----------------------------------------------------------------------------
#  ______   ______   __       ______   __   __   _____    ______   ______
# /\  ___\ /\  __ \ /\ \     /\  ___\ /\ "-.\ \ /\  __-. /\  __ \ /\  == \
# \ \ \____\ \  __ \\ \ \____\ \  __\ \ \ \-.  \\ \ \/\ \\ \  __ \\ \  __<
#  \ \_____\\ \_\ \_\\ \_____\\ \_____\\ \_\\"\_\\ \____- \ \_\ \_\\ \_\ \_\
#   \/_____/ \/_/\/_/ \/_____/ \/_____/ \/_/ \/_/ \/____/  \/_/\/_/ \/_/ /_/
#
# -----------------------------------------------------------------------------
@calendar_bp.route("/calendar", methods=['GET'])
@login_required
def main():
    form = TaskForm()

    tasks = models.db.session.query(
        models.Task
    ).filter(
        models.Task.user_id == current_user.id
    ).order_by(
        models.Task.created_on.desc()
    ).all()

    return render_template(
        'calendar/calendar.html',
        tasks=tasks, form=form,
    )
